name: Security

on:
    push:
        branches: [main]
    pull_request:
        branches: [main]
    schedule:
        - cron: "30 4 * * 1" # Weekly on Mondays

jobs:
    audit:
        name: Rust Security Audit
        runs-on: ubuntu-latest
        steps:
            - uses: actions/checkout@v4
            - uses: dtolnay/rust-toolchain@stable
            - name: Install cargo-audit
              uses: taiki-e/install-action@v2
              with:
                tool: cargo-audit
            - name: Run audit
              run: cargo audit

    # OpenSSF Scorecard disabled for private repositories
    # Re-enable when repository becomes public or when GitHub App permissions are configured
    # scorecard:
    #     name: OpenSSF Scorecard
    #     runs-on: ubuntu-latest
    #     permissions:
    #         security-events: write
    #         id-token: write
    #         contents: read
    #         actions: read
    #     steps:
    #         - uses: actions/checkout@v4
    #           with:
    #               persist-credentials: false
    #         - name: Run analysis
    #           uses: ossf/scorecard-action@v2.3.1
    #           with:
    #               results_file: results.sarif
    #               results_format: sarif
    #               publish_results: true
